package templates

type ModeInfo struct {
	ID          string
	Name        string
	Icon        string
	Description string
	Duration    string
	Cognitive   string
}

templ Home() {
	@Layout("DevSmith Review - Code Analysis") {
		<div class="review-container">
			<header class="review-header">
				<h1>üîç DevSmith Review</h1>
				<p class="subtitle">AI-powered code analysis with 5 reading modes</p>
			</header>

			<main class="review-main flex flex-col gap-8">
				@ModeSelector()
				@SessionForm()
				<!-- Dynamic Progress Indicator -->
				<div id="progress-indicator-container"></div>
				<!-- Reading Mode Display (mock integration) -->
				<div id="reading-mode-demo" class="mt-8">
					<!-- Preview Mode Example -->
					<h3 class="text-xl font-semibold mb-2">Preview Mode Example</h3>
					@PreviewModeResult("File tree and summary output here (mock)")
					<!-- Skim Mode Example -->
					<h3 class="text-xl font-semibold mt-6 mb-2">Skim Mode Example</h3>
					@SkimModeFunctionList([]string{"GetUser", "CreateUser", "DeleteUser"})
					<!-- Scan Mode Example -->
					<h3 class="text-xl font-semibold mt-6 mb-2">Scan Mode Example</h3>
					@ScanModeSearch()
					<!-- Detailed Mode Example -->
					<h3 class="text-xl font-semibold mt-6 mb-2">Detailed Mode Example</h3>
					@DetailedModeLineByLine([]string{"func GetUser(id int) {", "  // ...", "}"})
					<!-- Critical Mode Example -->
					<h3 class="text-xl font-semibold mt-6 mb-2">Critical Mode Example</h3>
					@CriticalModeIssueList([]CriticalModeIssue{
						{Description: "Handler calls DB directly (layer violation)", Severity: "Critical"},
						{Description: "SQL injection risk", Severity: "Critical"},
						{Description: "Missing error handling", Severity: "Important"},
					})
				</div>
			</main>
		</div>
	}
}

templ ModeSelector() {
	<div class="mode-selector">
		<h2>Choose Your Reading Mode</h2>
		<div class="modes-grid">
			@ModeCard(ModeInfo{
				ID:          "preview",
				Name:        "Preview",
				Icon:        "üëÅÔ∏è",
				Description: "Quick 2-minute overview of project structure and purpose",
				Duration:    "2-3 min",
				Cognitive:   "Low",
			})

			@ModeCard(ModeInfo{
				ID:          "skim",
				Name:        "Skim",
				Icon:        "‚ö°",
				Description: "Surface-level scan of architecture and key components",
				Duration:    "5-7 min",
				Cognitive:   "Low-Medium",
			})

			@ModeCard(ModeInfo{
				ID:          "scan",
				Name:        "Scan",
				Icon:        "üîé",
				Description: "Targeted search for specific patterns or issues",
				Duration:    "3-5 min",
				Cognitive:   "Medium",
			})

			@ModeCard(ModeInfo{
				ID:          "detailed",
				Name:        "Detailed",
				Icon:        "üìñ",
				Description: "Deep dive into implementation details and logic",
				Duration:    "10-15 min",
				Cognitive:   "High",
			})

			@ModeCard(ModeInfo{
				ID:          "critical",
				Name:        "Critical",
				Icon:        "üî¨",
				Description: "Comprehensive review focusing on correctness and quality",
				Duration:    "15-20 min",
				Cognitive:   "Very High",
			})
		</div>
	</div>
}

templ ModeCard(mode ModeInfo) {
	<div class="mode-card" data-mode={ mode.ID }>
		<div class="mode-icon">{ mode.Icon }</div>
		<h3>{ mode.Name }</h3>
		<p class="mode-description">{ mode.Description }</p>
		<div class="mode-meta">
			<span class="mode-duration">‚è±Ô∏è { mode.Duration }</span>
			<span class={ "cognitive-load " + mode.Cognitive }>üß† { mode.Cognitive }</span>
		</div>
		<button class="btn-select-mode" data-mode={ mode.ID }>Select { mode.Name }</button>
	</div>
}

templ RepoInput() {
	<div id="repo-input-section" class="repo-input-section hidden">
		<h2>Repository Details</h2>
		<form id="review-form">
			<div class="form-group">
				<label for="repository-url">Repository URL</label>
				<input
					type="url"
					id="repository-url"
					name="repository_url"
					placeholder="https://github.com/user/repo"
					required
				/>
				<span class="form-help">Only GitHub repositories are supported in MVP</span>
			</div>

			<div class="form-row">
				<div class="form-group">
					<label for="branch">Branch</label>
					<input
						type="text"
						id="branch"
						name="branch"
						placeholder="main"
						value="main"
					/>
				</div>

				<div class="form-group">
					<label for="commit-sha">Commit SHA (optional)</label>
					<input
						type="text"
						id="commit-sha"
						name="commit_sha"
						placeholder="abc123..."
					/>
				</div>
			</div>

			<input type="hidden" id="selected-mode" name="mode"/>

			<div class="form-actions">
				<button type="button" id="back-btn" class="btn-secondary">‚Üê Back to Modes</button>
				<button type="submit" id="analyze-btn" class="btn-primary">Start Analysis</button>
			</div>
		</form>
	</div>
}
